# 5. Paxos

## 5.1. 전설

### Paxos 섬의 고대 유물

## 5.2. 장애 유형

### 난이도 순 장애 유형

- 프로세스 간 장애의 유형
    - Fail-Stop : 프로세스가 문제점을 인지하고 스스로 즉시 구동을 멈추는 것
    - Crash : 프로세스가 완전히 죽어버리는 경우
    - Omission : 프로세스가 전송해야 하는 메시지를 누락시킨 경우 (일부만 누락)
    - Byzantine : 가장 복잡한 유형. 프로세스의 행동이 매우 무작위로 다양함. 정상적으로 응답하거나 응답하지 않을 수 있으며, 큰 지연이 있을 수도 있고, 잘못된 메시지가 전송될 수도 있음

<aside>
💡 장애는 발생하기 마련이고, 이에 잘 대응해야 하는 것이 분산 컴퓨팅의 핵심 기술임

</aside>

## 5.3. Paxos 알고리즘

- Paxos : 프로세스 간에 합의를 이끄는 알고리즘
    - 종결, 동의, 타당성 세가지 조건을 충족해야 함

### Paxos의 안전성과 라이브니스

- 안전성(Safety)
    - 오직 한 값만 합의에 의해서 선정되어야 함
    - 제안된 값만 선택 될 수 있음
    - 선택된 값만 프로세스들에 의해서 인지될 수 있음
- 라이브니스(Liveness)
    - 과반수 이상의 프로세스들이 정상이라면 제안된 어떤 값은 궁극적으로 선택됨
    - 어떤 값을 선택했다면 프로세스는 궁극적으로 그 값을 학습함
- 장애를 일으키는 프로세스가 전체의 반이 안 된다면(비율) 합의가 가능함

### Paxos 참여 프로세스 역할

- 제안자(Proposers) : 어떤 값을 제안함
- 수락자(Accepters)
    - 제안된 값을 수락함
    - 여러 제안 값들을 수락할 수 있음
    - 여러 값이 과반수의 수락자들에 의해서 선택되지 않는다면, 제안의 과정은 지속됨
- 학습자(Learners) : 수락한 값을 학습

### Paxos 3단계 수행 과정

## 5.4. Paxos 역으로 파헤치기

### Paxos 특성 분석

## 5.5. Paxos로 단절된 두뇌 문제 해결

### 2PC 프로토콜과 TC 장애

### 두뇌 단절 문제

### Paxos에 의한 리더 선정

## 핵심 요약

- 분산 컴퓨팅에서 장애는 크게 ‘비악의적(Bengin) 장애’와 ‘악의적 장애’로 구분함
- 비악의적 장애는
    - 프로세스가 중단되어 버리는 ‘Crash 장애’
    - 메시지가 누락되는 ‘Omission 장애’
    - 분산 컴퓨팅의 안정성 측면에서 가장 이상적인 장애는 ‘Fail-stop 장애’
        - 분산 프로세스가 장애 인지 즉시 구동을 멈추고 장애여부를 이웃 프로세스에게 알림
- 메시지 위변조, 의도적 메시지 누락 등 프로세스가 임의의 행동을 할 때 해당 프로세스가 악의적인 의도를 가지고 ‘Byzantine 장애’를 일으킴
- Paxos 알고리즘
    - 제안자, 수락자, 학습자 역할을 가진 분산 프로세스들이 3단계의 메시지 교환 과정을 거쳐 과반수의 무결한 프로세스들 간의 합의에 이름
    - Crash 및 Omission 장애에 대응하는 합의 알고리즘
    - 트랜잭션의 이행 과정을 조율하는 코디네이터 TC 등 리더 역할을 하는 프로세스 선정 문제 등에 활용 가능함
    - 리더 역할을 하는 프로세스들이 복수 존재하고 각자 자신이 리더라고 생각하고 있는 상태를 ‘두뇌 단절(Split Brain)’ 상태라고 함. 복수의 리더들이 내리는 지시는 혼선을 일으킬 수 있음
